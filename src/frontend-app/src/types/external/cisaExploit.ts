export type CisaExploit = {
  title: string;
  catalogVersion: string;
  count: number;
  vulnerabilities: Exploit[]
};

export type Exploit = {
  cveID: string;
  vendorProject: string;
};

// Type guard to check if an object is an Exploit
const isExploit = (obj: any): obj is Exploit => {
  return (
    typeof obj === "object" &&
    obj !== null &&
    typeof obj.cveID === "string" &&
    typeof obj.vendorProject === "string"
  );
};

// Type guard to check if an object is a CisaExploit
const isCisaExploit = (obj: any): obj is CisaExploit => {
  return (
    typeof obj === "object" &&
    obj !== null &&
    typeof obj.title === "string" &&
    typeof obj.catalogVersion === "string" &&
    typeof obj.count === "number" &&
    Array.isArray(obj.vulnerabilities) &&
    obj.vulnerabilities.every(isExploit)
  );
};

// Type guard to check if an array is CisaExploit[]
export const isCisaExploitArray = (data: any): data is CisaExploit[] => {
  return Array.isArray(data) && data.every(isCisaExploit);
};